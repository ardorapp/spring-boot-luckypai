<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cash.pai.lucky.dao.UserDao">
    <resultMap id="User" type="cash.pai.lucky.entity.UserEntity">
        <id property="userId" column="user_id"/>
        <result property="loginName" column="login_name"/>
        <result property="userName" column="user_name"/>
        <result property="password" column="password"/>
        <result property="phone" column="phone"/>
        <result property="email" column="email"/>
        <result property="sex" column="sex"/>
        <result property="realName" column="real_name"/>
        <result property="idCard" column="id_card"/>
        <result property="valid" column="valid"/>
        <result property="limitedIp" column="limited_ip"/>
        <result property="expiredTime" column="expired_time"/>
        <result property="lastChangePwdTime" column="last_change_pwd_time"/>
        <result property="limitMultiLogin" column="limit_multi_login"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
    </resultMap>

    <sql id="Base_Column_List">
        user_id, login_name,user_name,valid,limited_ip,expired_time,last_change_pwd_time,create_time,update_time,
        phone,email,sex,real_name,id_card
    </sql>

    <select id="findById" resultMap="User" parameterType="java.lang.String">
        SELECT
        <include refid="Base_Column_List"/>
        FROM
        sys_user
        WHERE user_id= #{userId}
    </select>


    <select id="findByCondition" resultMap="User" parameterType="cash.pai.lucky.entity.UserEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM
        sys_user
        <where>
            <if test="userId != null">
                user_id= ${userId}
            </if>
            <if test="loginName != null">
                AND login_name = ${loginName}
            </if>
            <if test="userName != null">
                AND user_name = #{userName}
            </if>
        </where>
    </select>

    <insert id="insert" parameterType="cash.pai.lucky.entity.UserEntity">
		insert into sys_user
        (
            user_id,login_name ,last_change_pwd_time,limit_multi_login, user_name,password,valid,create_time,update_time,phone,email,sex,real_name,id_card
        )
		values
		(   #{userId}, #{loginName},#{lastChangePwdTime}, #{limitMultiLogin},   #{userName},#{password},#{valid},#{createTime},#{updateTime},#{phone},#{email},#{sex},#{realName},#{idCard})
	</insert>
    
    <update id="activeUser">
        UPDATE sys_user SET valid ='Y' , update_time=NOW()
        WHERE  user_name= #{userName} and  valid='N'
    </update>
    
</mapper>